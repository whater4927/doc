# 统一用户管理产品需求规格说明书

文档版本：1.0

产品版本：${version}

-----

## 1. 内容目录

{toc}

## 2. 文档信息

### 2.1. 文档目标

目标读者：开发人员。

让开发人员理解需求规格，统一目标。

### 2.2. 修订历史

| 时间      | 版本 | 内容                     | 修订人 |
| --------- | ---- | :----------------------- | :----: |
| 2019-7-26 | 1.1  | 主要修订了markdown的内容 |  滕伟  |
| 2019-2-15 | 1.0  | 初始版本，主要编写了     | 彭永勇 |
|           |      |                          |        |

### 2.3. 相关术语

| 术语 | 说明         |
| ---- | ------------ |
| Idm  | 统一用户管理 |
|      |              |
|      |              |

## 3. 需求规格

### 4.6.4产品需求规格

#### #26149-用户管理- 基于组织授权后，批量新建用户授权失败

| 参数                       | 说明                                                     |
| -------------------------- | :------------------------------------------------------- |
| 需求编号                   | [#26149](http://10.18.42.59/issues/26149)                |
| 用例名称                   | 用户管理- 基于组织授权后，批量新建用户授权失败           |
| 功能编号                   |                                                          |
| 触发事件                   |                                                          |
| 前置条件                   | 管理员设置组织授权，并且勾选了继承子组织权限             |
| 交互事件流程<br>（活动图） | ![流程]()                                                |
| 用例说明                   | 1.组织授权后在子组织新建用户，用户可继承父级组织权限<br> |
| 后置条件                   |                                                          |
| 业务规则                   |                                                          |
| 数据定义                   |                                                          |
| 非功能要求                 |                                                          |
| 原型图                     | ![原型]()                                                |



### 4.7.4产品需求规格



#### #26220-同步管理-解决权限推送时报错，未生成推送日志的问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26220](http://10.18.42.59/issues/26220)                    |
| 用例名称                   | 同步管理-解决权限推送时报错，未生成推送日志的问题            |
| 功能编号                   |                                                              |
| 触发事件                   | 同步推送                                                     |
| 前置条件                   | 已配置同步推送                                               |
| 交互事件流程<br>（活动图） |                                                              |
| 用例                       | 1.修复同步推送偶尔读取不到映射属性的问题<br>2.支持待同步数据手动重试 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #26996-支持按用户（账号）查询，返回该用户所授权过的应用系统接口

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26996](http://10.18.42.59/issues/26996)                    |
| 用例名称                   | 支持按用户（账号）查询，返回该用户所授权过的应用系统接口     |
| 功能编号                   |                                                              |
| 触发事件                   | 查询用户授权的应用系统                                       |
| 前置条件                   | 用户授权过并且权限已解析                                     |
| 交互事件流程<br>（活动图） |                                                              |
| 用例                       | 266191.传入用户userid，返回用户所有授权过的IT系统信息<br>2.三种参数 权限，角色，全部 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26644-用户管理-改进修改/重置密码，密码策略不允许包含用户属性时，大小写属性都禁止使用

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26644](http://10.18.42.59/issues/26644)                    |
| 用例名称                   | 用户管理-改进修改/重置密码，密码策略不允许包含用户属性时，大小写属性都禁止使用 |
| 功能编号                   |                                                              |
| 触发事件                   | 修改/重置密码                                                |
| 前置条件                   | 密码策略配置了不包含用户属性                                 |
| 交互事件流程<br>（活动图） |                                                              |
| 用例                       | 1.支持密码策略配置不允许包含用户属性时，大小写均不允许修改<br>2.支持配置大小写是否敏感<br>3.默认大小写敏感，支持升级时没有此配置也可正常使用 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25896-支持按组织用户 查看权限时，可查看权限的扩展属性（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25896](http://10.18.42.59/issues/25896)                    |
| 用例名称                   | 权限管理-支持按组织用户 查看权限时，可查看权限的扩展属性     |
| 功能编号                   |                                                              |
| 触发事件                   | 管理员点击用户权限对应的详细信息                             |
| 前置条件                   | 用户权限关系设置了扩展字段                                   |
| 交互事件流程<br>（活动图） | ![流程](http://assets.processon.com/chart_image/5d412963e4b0e6d919a2962b.png) |
| 用例说明                   | 1.可查看权限及角色关系的扩展属性<br>                   |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![原型](http://assets.processon.com/chart_image/5d412be8e4b065dc42b8c1ca.png) |



#### #25857-同步管理-支持修改资源,切换新版本连接器时，带入原版本的连接器参数（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25857](http://10.18.42.59/issues/25857)                    |
| 用例名称                   | 同步管理-支持修改资源,切换新版本连接器时，带入之前版本的连接器参数 |
| 功能编号                   |                                                              |
| 触发事件                   | 管理员更新资源的连接器                                       |
| 前置条件                   | 资源已经设置过连接器                                         |
| 交互事件流程<br>（活动图） | ![流程](http://assets.processon.com/chart_image/5d412f6ae4b092b3346f9466.png) |
| 用例                       | 1.切换连接器后可将原有连接器参数导入新的连接器页面<br> |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



#### #22378-支持用户与业务角色关系属性扩展

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22378](http://10.18.42.59/issues/22378)                    |
| 用例名称                   | 权限管理-支持用户与业务角色关系属性扩展                      |
| 功能编号                   |                                                              |
| 触发事件                   | 管理员设置业务角色扩展属性                                   |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![流程](http://assets.processon.com/chart_image/5d4133dbe4b058ef96bb314e.png) |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.业务角色支持用户授权时设置扩展属性 \\\\ 2.用户关联业务角色时支持设置过期时间，同时可通过定时任务定时解除过期授权关系 \\\\ 3.支持通过接口设置业务角色关系属性V2及V3版本 \\\\ 4.支持通过接口查询业务角色关系及关系属性 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



### 4.9.1产品需求规格

#### #25893-同步管理-修复回收上游HR BLOB类型头像属性，在SIM/SIS中无法正常显示（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25893](http://10.18.42.59/issues/25893)                    |
| 用例名称                   | 同步管理-修复回收上游HR BLOB类型头像属性，在SIM/SIS中无法正常显示 |
| 功能编号                   |                                                              |
| 触发事件                   | 同步回收用户图片                                             |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   | 1.支持回收byte类型图片数据到SIM                        |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



#### #25661-支持SIAM多属性认证时写入日志在SIA中识别为1个用户，而不是多个用户

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25661](http://10.18.42.59/issues/25661)                    |
| 用例名称                   | 支持SIAM多属性认证时写入日志在SIA中识别为1个用户，而不是多个用户 |
| 功能编号                   |                                                              |
| 触发事件                   | 用户多属性认证                                               |
| 前置条件                   | SIAM配置多属性认证                                           |
| 交互事件流程<br>（活动图） | ![流程](http://assets.processon.com/chart_image/5d413f8fe4b092b3346fc53c.png) |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   | ``` 日志数据结构：<br>操作时间，应用编码，操作对象，操作事件，操作人，服务器IP，目标对象IP，扩展属性<br>Tue Jul 30 17:02:15 CST 2019,SIAM,ST-1-YSsO5UqtRi9SQOuepjNe-SIAM,SERVICE_TICKET_CREATED,lpl,10.199.251.245,10.199.251.245,{"uid":"lpl"}``` |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #22187-同步管理-企业微信，支持多企业微信数据同步回收及推送，支持企业微信绑定推送（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22187](http://10.18.42.59/issues/22187)                    |
| 用例名称                   | 同步管理-企业微信，支持多企业微信数据同步回收及推送，支持企业微信绑定推送 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   |                                                        |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



### 4.10.0产品需求规格



#### #26226-修复审计统计日志记录不明确的问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26226](http://10.18.42.59/issues/26226)                    |
| 用例名称                   | 修复审计统计日志记录不明确的问题                             |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.用户解关联权限操作对象记录的是权限编号,无人员ID<br>2.人员移动时操作对象记录的是目标部门，无原部门<br>3.部门移动时操作对象是目标部门，无原部门<br>4.检查所有操作，是否还有其他信息不全的情况，移动需记录原部门及目标部门，授权解权限操作需记录人员与权限编号<br>5.权限解析数据没有审计记录，同时记录授权来源 |
|                            |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #26227-同步管理-解决大批量同步推送，造成排队和堵塞，从而导致敏感操作（个人授权，修改密码等）推送不及时的问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26227](http://10.18.42.59/issues/26227)                    |
| 用例名称                   | 同步管理-解决大批量同步推送，造成排队和堵塞，从而导致敏感操作（个人授权，修改密码等）推送不及时的问题 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.特殊事件走实时推送，并返回推送结果，避免大数据量同步时队列阻塞影响<br>2.哪些推送走实时推送规则可配置 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26229-用户管理-创建用户，UID及别名使用非拼音策略时，用户新建对话框上不需要按钮点击生成

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26229](http://10.18.42.59/issues/26229)                    |
| 用例名称                   | 用户管理-创建用户，UID及别名定义为非拼音策略时，用户新建对话框上不需要按钮点击生成 |
| 功能编号                   |                                                              |
| 触发事件                   | 创建用户                                                     |
| 前置条件                   | 配置非拼音的UID生成策略或别名生成策略                        |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.UID使用非拼音策略时，用户新建对话框上不需要按钮点击生成UID<br>2.别名使用非拼音策略时，用户新建对话框上不需要按钮点击生成别名 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26231-权限管理- 按组织用户查询用户的权限或角色，支持按应用系统，来源等排序，支持按条件过滤

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26231](http://10.18.42.59/issues/26231)                    |
| 用例名称                   | 权限管理- 按组织用户查询用户的权限或角色，支持按应用系统，来源等排序，支持按条件过滤 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.支持按应用系统，来源等排序<br>2.支持按过滤条件过滤查询，如IT系统，授权来源 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26233-优化大数据量环境下用户体验，很多地方查询很慢，如权限角色树（几千条），同步日志（几十万），查询时间很长。

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26233](http://10.18.42.59/issues/26233)                    |
| 用例名称                   | 优化大数据量环境下用户体验，很多地方查询很慢，如权限角色树（几千条），同步日志（几十万），查询时间很长。 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.大数据量展示支持分页展示<br>2.大数据量展示支持条件查询     |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26326-解决SIAM启用HTTPS，客户端集成SIAM，需要导入SIAM证书，证书过期客户端无法访问的问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26326](http://10.18.42.59/issues/26326)                    |
| 用例名称                   | 解决SIAM启用HTTPS，客户端集成SIAM，需要导入SIAM证书，证书过期客户端无法访问的问题 |
| 功能编号                   |                                                              |
| 触发事件                   | 应用进行单点登录集成                                         |
| 前置条件                   | SIAM配置了HTTPS                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.支持SIAM启用https，客户端不导入SIAM证书也可以正常集成<br>2.SIAM证书过期，集成应用可正常使用<br> |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #26346-同步管理-解决同步推送企业微信，腾讯企业邮箱等需要导入证书问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26346](http://10.18.42.59/issues/26346)                    |
| 用例名称                   | 同步管理-解决同步推送企业微信，腾讯企业邮箱等需要导入证书问题 |
| 功能编号                   |                                                              |
| 触发事件                   | 同步回收或推送                                               |
| 前置条件                   | 导入对应证书                                                 |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 263261.支持企业微信同步，腾讯企业邮箱同步等调用权威机构颁发了证书的URL地址，不需要导入证书即可调用接口<br>2.不影响原有SIM内置的证书，如和SIAM交互用到的公私钥，比如强制修改密码，可正常跳转 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26491-单点登录-提供前后端分离应用的单点登录集成方案

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26491](http://10.18.42.59/issues/26491)                    |
| 用例名称                   | 单点登录-提供前后端分离应用的单点登录集成方案                |
| 功能编号                   |                                                              |
| 触发事件                   | 前后端分离应用应用进行单点登录集成                           |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.支持springboot应用，纯前端应用，前后端分离应用的单点登录集成方案<br>2.提供客户端集成demo，集成配置文档（客户端及服务器端）<br>3.提供所有支持的集成方式的支持方案，如oauth，saml，filter等 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26515-单点登录-浏览器中存在TGT，需要全链路检查追踪TGT，检验其合法与不合法

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26515](http://10.18.42.59/issues/26515)                    |
| 用例名称                   | 单点登录-浏览器中存在TGT，需要全链路检查追踪TGT，检验其合法与不合法 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.TGT的获取，校验流程，是否合法等整个认证流程要有日志记录，方便分析问题 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26538-用户管理-支持用户授权审计日志加入IT系统编号，授权来源，授权来源编号

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26538](http://10.18.42.59/issues/26538)                    |
| 用例名称                   | 用户管理-支持用户授权审计日志加入IT系统编号，授权来源，授权来源编号 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.支持用户授权审计日志加入IT系统编号，授权来源，授权来源编号<br>2.用户多个来源记录多条数据 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   | ``` 扩展4个扩展属性：permId(权限编号),roleId（角色编号）,appId（应用编号）,authObjId（授权来源ID）,authObjType(授权来源类型)日志数据结构：<br/>操作时间，应用编码，操作对象，操作事件，操作人，服务器IP，目标对象IP，扩展属性<br/>Tue Jul 30 17:02:15 CST 2019,SIAM,ST-1-YSsO5UqtRi9SQOuepjNe-SIAM,SERVICE_TICKET_CREATED,lpl,10.199.251.245,10.199.251.245,{"permId":"lpl","roleId","1231","appId":"","resourceId":"","resourceType":"User"}``` |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #26234-权限管理-支持权限禁用，删除时同步取消该权限的授权关系，因操作的敏感性，加入确认机制及审计日志

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26234](http://10.18.42.59/issues/26234)                    |
| 用例名称                   | 权限管理-支持权限禁用，删除时同步取消该权限的授权关系，因操作的敏感性，加入确认机制及审计日志 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.权限禁用/删除时同步取消该权限的授权关系，包括用户，组织，群组，岗位与群组与权限关系<br>2.权限禁用/删除时给出提示，及确认机制<br>3.审计日志记录操作结果，具体到人的授权关系 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #25638-单点登录-console新UI调整

| 参数                       | 说明                                                 |
| -------------------------- | :--------------------------------------------------- |
| 需求编号                   | [#25638](http://10.18.42.59/issues/25638)            |
| 用例名称                   | 单点登录-console新UI调整，调整为美云之前设计的风格   |
| 功能编号                   |                                                      |
| 触发事件                   |                                                      |
| 前置条件                   |                                                      |
| 交互事件流程<br>（活动图） |                                                |
| 用例说明                   | 1.之前设计的console的UI并没有实现，需要实现完善|
| 后置条件                   |                                                      |
| 业务规则                   |                                                      |
| 数据定义                   |                                                      |
| 非功能要求                 |                                                      |
| 原型图                     |                                                |



#### #22084-同步管理-同步易用性调整

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22084](http://10.18.42.59/issues/22084)                    |
| 用例名称                   | 同步管理-同步易用性调整                                      |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1. 连接器配置优化，选择连接器后默认加载其必填属性，按照样例进行修改保存即可（实现方法：修改每个连接器，必填字段赋值默认值）<br/>2. 属性映射配置优化，页面新增【一键生成】按钮，点击自动生成，默认生成并在页面显示所有连接器属性，处理器-默认、映射标识-默认、数量限制-无、能否新增/修改-是，用户只需配置与之映射的本地属性、更改映射标识、数量限制等即可<br/>3. 操作配置优化，属性映射配置界面，用户点击保存，弹窗确认框【是否自动生成操作配置触发条件】，点击确认，新增/删除/全量同步删除对象->主键为触发条件、启用/禁用对象->状态为触发条件、移动对象->父级为触发条件、 修改密码->密码为触发条件、修改对象->剩余字段为触发条件<br/>4. 同步标记时间戳，可在资源首页进行编辑<br/>5. 定时任务名称设置中文无法使用问题解决<br/>6. 同步策略配置优化，删除同步策略中很多无用的策略，对于各个策略给出描述及作用 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #22336-同步管理-同步效率优化

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22336](http://10.18.42.59/issues/22336)                    |
| 用例名称                   | 同步管理-同步效率优化                                        |
| 功能编号                   |                                                              |
| 触发事件                   | 1.同步日志出现待同步触发<br>                                 |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.同步数量优化，支持百万级别数量同步<br/>2.同步效率优化，提升同步效率<br>3.同步稳定性优化，解决待同步问题<br>4.支持待同步记录可手动重试<br>5.触发推送即记录日志，不能遗漏 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #22335-SIM常用数据库表结构整理

| 参数                       | 说明                                                     |
| -------------------------- | :------------------------------------------------------- |
| 需求编号                   | [#22335](http://10.18.42.59/issues/22335)                |
| 用例名称                   | 常用数据库表结构整理                                     |
| 功能编号                   |                                                          |
| 触发事件                   |                                                          |
| 前置条件                   |                                                          |
| 交互事件流程<br>（活动图） |                                                    |
| 用例说明                   | 1.SIM常用数据库表结构整理，输出表结构及字段说明文档|
| 后置条件                   |                                                          |
| 业务规则                   |                                                          |
| 数据定义                   |                                                          |
| 非功能要求                 |                                                          |
| 原型图                     |                                                    |



#### #22334-单点登录-异地登录提醒调整

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22334](http://10.18.42.59/issues/22334)                    |
| 用例名称                   | 单点登录-异地登录提醒调整                                    |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   | 1.异地登录提醒优化为调用SIDL接口，删除之前添加的kafka相关的包|
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



#### #25957-用户自助-自助整合PORTAL单点登录门户功能

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25957](http://10.18.42.59/issues/25957)                    |
| 用例名称                   | 用户自助-自助整合PORTAL单点登录门户功能                      |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1. 自助集成PORTAL门户功能，保留PORTAL原有功能<br/>2. 门户功能可通过权限控制是否展示此功能<br>3.SIM中可设置应用系统是否展示<br>4.SIM中可针对应用进行分类 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25958-用户自助-自助整合PORTAL邮箱单点登录功能

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25958](http://10.18.42.59/issues/25958)                    |
| 用例名称                   | 用户自助-自助整合PORTAL邮箱单点登录功能                      |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   | 1. SIM可配置邮箱单点登录资源<br>2.自助可根据资源配置点击邮箱链接实现邮箱单登录|
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



#### #22332-权限管理-权限模块拆分

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22332](http://10.18.42.59/issues/22332)                    |
| 用例名称                   | 权限管理-权限模块拆分                                        |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   | SIM权限管理需拆分权限模块，默认出厂只有单点登录权限，如需细粒度权限需系统设置中打开，也可同时开启<br/>1.客户只购买了权限模块<br/>2.客户只购买了账号管理及单点登录<br/>3.客户购买了权限管理及账号管理及单点登录|
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |





#### #25766-单点登录-支持防止反射型XSS攻击（完成）

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#25766](http://10.18.42.59/issues/25766) |
| 用例名称                   | 单点登录-支持防止反射型XSS攻击            |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） |                                     |
| 用例说明                   |                                     |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                     |



#### #22328-单点登录-TGT,JWT,LtpaToken票据加密，绑定浏览器及IP，防止票据泄露（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22328](http://10.18.42.59/issues/22328)                    |
| 用例名称                   | 单点登录-TGT,JWT,LtpaToken票据加密，绑定浏览器及IP，防止票据泄露 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   |                                                        |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |



#### #22327用户管理-用户管理系统支持从账号管理（完成）

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#22327](http://10.18.42.59/issues/22327) |
| 用例名称                   | 用户管理-用户管理系统支持从账号管理       |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） |                                     |
| 用例说明                   |                                     |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                     |



#### #22326 用户管理-用户自助可维护默认从账号（完成）

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#22326](http://10.18.42.59/issues/22326) |
| 用例名称                   | 用户管理-用户自助可维护默认从账号         |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） |                                     |
| 用例说明                   |                                     |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                     |



#### #22325 单点登录-单点登录支持选择从账号登录系统（完成）

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22325](http://10.18.42.59/issues/22325)                    |
| 用例名称                   | 单点登录-单点登录支持选择从账号登录系统                      |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                        |
| 用例说明                   | 1.SIAM控制台可控制应用使用从账号登录还是主账号登录，如果没有从账号需要主账号进入<br/>2.如勾选从账号登录则访问应用时读取从账号，也可以选择主账号<br/>3.根据配置显示是否显示选择从账号<br/>4.显示选择页面，默认勾选默认从账号<br/>5.不显示选择页面，默认使用默认从账号登录系统，如果没有默认从账号，则使用主账号登录<br/>6.访问其他应用保持正常流程，可正常单点。<br/>7.考虑委托授权和从账号选择同时启用的情况|
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                        |





#### #25970 单点登录-单点登录跨域互信（完成）

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#25970](http://10.18.42.59/issues/25970) |
| 用例名称                   | 单点登录-单点登录跨域互信                 |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） |                                     |
| 用例说明                   |                                     |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                     |



#### #25971 同步管理-同步回收支持事件数量限制，支持指定字段修改数量限制（完成）

| 参数                       | 说明                                                        |
| -------------------------- | :---------------------------------------------------------- |
| 需求编号                   | [#25971](http://10.18.42.59/issues/25971)                   |
| 用例名称                   | 同步管理-同步回收支持事件数量限制，支持指定字段修改数量限制 |
| 功能编号                   |                                                             |
| 触发事件                   |                                                             |
| 前置条件                   |                                                             |
| 交互事件流程<br>（活动图） |                                                       |
| 用例说明                   |                                                       |
| 后置条件                   |                                                             |
| 业务规则                   |                                                             |
| 数据定义                   |                                                             |
| 非功能要求                 |                                                             |
| 原型图                     |                                                       |



#### #25972 同步管理-同步支持只创建，修改部分属性（完成）

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#25972](http://10.18.42.59/issues/25972) |
| 用例名称                   | 同步管理-同步支持只创建，修改部分属性     |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） |                                     |
| 用例说明                   |                                     |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                     |





#### #26095 用户管理-改进升级数据库脚本及表结构定义及升级配置改动

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26095](http://10.18.42.59/issues/26095)                    |
| 用例名称                   | 用户管理-改进升级数据库脚本及表结构定义及升级配置改动        |
| 功能编号                   |                                                              |
| 触发事件                   | 项目升级                                                     |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 升级目前存在以下问题：<br>1.新版本有新的数据库表，需要导入脚本<br>2.新版本有新的数据库数据，需要导入脚本<br>3.新版本添加了新的配置，需要修改配置<br>4.升级脚本可能有错误，无法完成导入<br>5.小版本有数据库改动，升级无法覆盖到<br>6.新版本数据库脚本有开关改动，本来没开的开关打开了<br>7.不知道配置修改涉及哪个功能，有什么影响 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.新版本添加的表，全部采用代码映射生成，升级不用导入脚本<br>2.保证数据库脚本无错误，并且可重复导入<br>3.新版本添加的配置，数据库脚本保证有默认值，即不添加配置也可正常使用<br>4.所有配置，数据库脚本有SPM需求编号的关联SPM编号，说明改动关联的功能<br>5.目标：4.10.0以后，任意低版本升级不需要改动配置，不需要导入脚本即可升级成功，只是所有新增功能采用默认配置<br>6.4.10.0只做到把升级脚本整合成一个并且可重复导入 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25919-自助服务-自助修改密保手机，短信验证码发送新手机号码

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25919](http://10.18.42.59/issues/25919)                    |
| 用例名称                   | 自助服务-自助修改密保手机，短信验证码发送新手机号码          |
| 功能编号                   |                                                              |
| 触发事件                   | 用户自助修改密保手机                                         |
| 前置条件                   | 用户已登录                                                   |
| 交互事件流程<br>（活动图） | ![流程](http://assets.processon.com/chart_image/5d413cb1e4b02015bd913bda.png) |
| 用例说明                   | 1.添加开关，发送到旧的手机验证还是发送到新手机验证支持配置<br>2.默认发送旧的手机<br>3.如果没有配置，默认可用，发送旧手机 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25895-用户管理-帐号启用增加重置密码和短信通知功能，帐号禁用增加重置密码功能

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25895](http://10.18.42.59/issues/25895)                    |
| 用例名称                   | 用户管理-帐号启用增加重置密码和短信通知功能，帐号禁用增加重置密码功能 |
| 功能编号                   |                                                              |
| 触发事件                   | 管理员启用，禁用账号                                         |
| 前置条件                   | 系统配置了短信邮件通知                                       |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.添加开关，启用是否重置密码，是否发送通知（短信，邮件）<br>2.添加开关，禁用是否重置密码<br>3.默认不发送通知和重置密码<br>4.没有配置时采用默认配置<br>5.禁用用户不允许发送通知 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25892-用户管理-支持IDM禁用帐号操作修改重置密码不发送通知

| 参数                       | 说明                                               |
| -------------------------- | :------------------------------------------------- |
| 需求编号                   | [#25892](http://10.18.42.59/issues/25892)          |
| 用例名称                   | 用户管理-支持IDM禁用帐号操作修改重置密码不发送通知 |
| 功能编号                   |                                                    |
| 触发事件                   | 1.管理员重置禁用账号的密码<br>2.同步回收禁用账号   |
| 前置条件                   |                                                    |
| 交互事件流程<br>（活动图） |                                                    |
| 用例说明                   | 1.禁用账号任何事件都不发送任何通知                 |
| 后置条件                   |                                                    |
| 业务规则                   |                                                    |
| 数据定义                   |                                                    |
| 非功能要求                 |                                                    |
| 原型图                     |                                                    |



#### #25685-用户管理-用户首页可过滤在职或离职用户

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25685](http://10.18.42.59/issues/25685)                    |
| 用例名称                   | 用户管理-用户首页可过滤在职或离职用户                        |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.首页添加显示在职，显示离职，全部显示下拉选项，控制用户显示 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25879-用户管理-触发器管理支持编辑修改，支持输入中文，支持合法性校验

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25879](http://10.18.42.59/issues/25879)                    |
| 用例名称                   | 用户管理-触发器管理支持编辑修改，支持输入中文，支持合法性校验 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.支持输入中文<br>2.支持编辑触发器<br>3.同步管理中定时任务页面可查看描述<br> |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25876-用户管理-系统设计、操作、界面风格及操作方式统一

| 参数                       | 说明                                            |
| -------------------------- | :---------------------------------------------- |
| 需求编号                   | [#25876](http://10.18.42.59/issues/25876)       |
| 用例名称                   | 用户管理-系统设计、操作、界面风格及操作方式统一 |
| 功能编号                   |                                                 |
| 触发事件                   |                                                 |
| 前置条件                   |                                                 |
| 交互事件流程<br>（活动图） |                                                 |
| 用例说明                   | 1.界面样式、布局、按钮统一                      |
| 后置条件                   |                                                 |
| 业务规则                   |                                                 |
| 数据定义                   |                                                 |
| 非功能要求                 |                                                 |
| 原型图                     |                                                 |



#### #25874-同步管理- 连接器字段增加连接器字段搜索功能

| 参数                       | 说明                                       |
| -------------------------- | :----------------------------------------- |
| 需求编号                   | [#25874](http://10.18.42.59/issues/25874)  |
| 用例名称                   | 同步管理- 连接器字段增加连接器字段搜索功能 |
| 功能编号                   |                                            |
| 触发事件                   |                                            |
| 前置条件                   |                                            |
| 交互事件流程<br>（活动图） |                                            |
| 用例说明                   | 1.支持按名称，按资源搜索                   |
| 后置条件                   |                                            |
| 业务规则                   |                                            |
| 数据定义                   |                                            |
| 非功能要求                 |                                            |
| 原型图                     |                                            |



#### #25872-同步管理-同步日志拆分成单独日志文件，大量同步数据时，不便于观察其他错误。

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25872](http://10.18.42.59/issues/25872)                    |
| 用例名称                   | 同步管理-同步日志拆分成单独日志文件，大量同步数据时，不便于观察其他错误。 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.同步日志拆分单独日志文件<br>2.同步日志支持日志切割         |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25871-同步管理-同步日志查询增加单条记录的属性查询，比如用户、权限、状态等。目前是批次显示，支持直接查询对应对象的同步日志

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25871](http://10.18.42.59/issues/25871)                    |
| 用例名称                   | 同步管理-同步日志查询增加单条记录的属性查询，比如用户、权限、状态等。目前是批次显示，支持直接查询对应对象的同步日志 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.同步日志支持按对象ID模糊查询<br>2.支持按同步状态，同步时间，同步资源等多条件查询<br>3.查询结果支持按时间排序 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25868-权限管理-权限支持存储业务系统权限编号，并支持通过业务系统权限编号授权

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25868](http://10.18.42.59/issues/25868)                    |
| 用例名称                   | 权限管理-权限支持存储业务系统权限编号，并支持通过业务系统权限编号授权 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.权限，角色扩展业务系统编号字段，IT系统内唯一<br>2.支持接口按业务系统编号授权及查询权限 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25865-系统设置-部门管理及其他管理员授权操作优化，支持直接勾选具体权限授权，而不用设置很多东西

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25865](http://10.18.42.59/issues/25865)                    |
| 用例名称                   | 系统设置-部门管理及其他管理员授权操作优化，支持直接勾选具体权限授权，而不用设置很多东西 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.用户授权统一在一个页面操作                                 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25862-同步管理-支持权限模块点击保存授权按钮重新触发权限解析和同步推送，保障下游与IDM数据一致

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25862](http://10.18.42.59/issues/25862)                    |
| 用例名称                   | 同步管理-支持权限模块点击保存授权按钮重新触发权限解析和同步推送，保障下游与IDM数据一致 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.编辑权限关系过期时间,触发权限推送<br>2.编辑用户权限关系属性，触发权限推送<br>3.未做任何变更，直接保存也触发推送，是否产生实际推送事件由同步模块判断 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #25775-单点登录-saml支持单点登出(完成)

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#25775](http://10.18.42.59/issues/25775)                    |
| 用例名称                   | 单点登录-oauth,saml支持单点登出                              |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | AML支持单点登出<br>1.SIAM登出通知SAML应用端<br>2.PORTAL支持单点登出<br>3.提供应用端登出开发文档 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #26550-融合认证-支持企业微信小程序的SAK版本

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26550](http://10.18.42.59/issues/26550)                    |
| 用例名称                   | 融合认证-支持企业微信小程序的SAK版本                         |
| 功能编号                   |                                                              |
| 触发事件                   | SIAM开启二次认证/扫码一次认证                                |
| 前置条件                   | SIAM开启二次认证/扫码一次认证                                |
| 交互事件流程<br>（活动图） | ![单企业微信SAK认证流程](http://assets.processon.com/chart_image/5d56125ae4b01f02f5553ba9.png) <br>![多企业微信SAK认证流程](http://assets.processon.com/chart_image/5d5619d9e4b0ac2b617b5739.png)<br>![企业微信扫码认证流程](http://assets.processon.com/chart_image/5d5621aee4b06e49191549f5.png)<br>![SAK小程序二次认证流程](http://assets.processon.com/chart_image/5d564049e4b0d7807700b9b2.png) |
| 用例说明                   | 1.支持单企业微信的SAK小程序<br>2.支持多企业微信的SAK小程序<br>3.支持返回任意登录字段和多字段登录<br>4.支持同一个企业有多个SAK小程序，不用的应用扫码可调用对应的SAK小程序<br>5.改进企业微信小程序通知<br>6.使用不匹配的小程序进行二次认证，需给出错误提示<br>7.多个设备同时登录，等待二次认证，只允许对应通知完成了二次认证的设备进入<br>8.若二次认证通知未收到或小程序未登录，则需SIAM重新登录<br>9.UI重新设计，有些依赖通知的UI默认不显示 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |







#### #26754-用户自助-自助上展示用户近期登录和访问轨迹

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26754](http://10.18.42.59/issues/26754)                    |
| 用例名称                   | 用户自助-自助上展示用户近期登录和访问轨迹                    |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.用户自助可访问用户近期登录和访问轨迹，和操作变更记录<br>2.调用sidl实现<br>3.sidl未配置则显示无数据 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26756-单点登录-支持单点登录认证时日志记录认证类型（账号+密码、手机短信、企业微信）日志并分析

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26756](http://10.18.42.59/issues/26756)                    |
| 用例名称                   | 单点登录-支持单点登录认证时日志记录认证类型（账号+密码、手机短信、企业微信）日志并分析 |
| 功能编号                   |                                                              |
| 触发事件                   | 用户认证                                                     |
| 前置条件                   | 用户认证                                                     |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 日志需要记录详细认证类型供SIA分析数据                        |
| 后置条件                   |                                                              |
| 业务规则                   | 1.单点登录-支持单点登录认证时日志记录认证类型（账号+密码、手机短信、企业微信）日志并分析<br>2.一次认证类型：<br/>用户名密码<br/>指纹<br/>人脸<br/>sak扫码<br/>短信<br/>QQ授权<br/>微博授权<br/>微信扫码<br/>企业微信扫码<br/>阿里钉钉扫码<br/>免密认证（CAS级联互信）<br/><br/>3.二次认证：<br/>人脸<br/>指纹<br/>SAK扫码<br/>动态码<br/>手势<br/>短信 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26743-用户管理-SIM新建组织用户类型支持从其他类型复制字段，避免新建用户/组织类型时缺少字段部分功能不可用

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26743](http://10.18.42.59/issues/26743)                    |
| 用例名称                   | 用户管理-SIM新建组织用户类型支持从其他类型复制字段，避免新建用户/组织类型时缺少字段部分功能不可用 |
| 功能编号                   |                                                              |
| 触发事件                   | 创建新组织/用户类型                                          |
| 前置条件                   | 创建新组织/用户类型                                          |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.新建用户类型支持选择从其他类型复制字段<br>2.默认必须选择一个类型进行字段复制 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26997-用户管理-优化审计统计,SIM操作记录查询，查询速度较慢

| 参数                       | 说明                                                  |
| -------------------------- | :---------------------------------------------------- |
| 需求编号                   | [#26997](http://10.18.42.59/issues/26997)             |
| 用例名称                   | 用户管理-优化审计统计,SIM操作记录查询，查询速度较慢   |
| 功能编号                   |                                                       |
| 触发事件                   | 查询审计信息                                          |
| 前置条件                   | 审计信息写入数据库                                    |
| 交互事件流程<br>（活动图） |                                                       |
| 用例说明                   |                                                       |
| 后置条件                   |                                                       |
| 业务规则                   | 1.审计查询支持分页<br>2.优化审计查询sql，提升查询效率 |
| 数据定义                   |                                                       |
| 非功能要求                 |                                                       |
| 原型图                     |                                                       |



#### #26998-用户管理-支持定时任务配置参数

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26998](http://10.18.42.59/issues/26998)                    |
| 用例名称                   | 用户管理-支持定时任务配置参数                                |
| 功能编号                   |                                                              |
| 触发事件                   | 添加定时任务                                                 |
| 前置条件                   | 定时任务需要配置参数                                         |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.定时任务支持配置参数供定时任务调用时使用<br>2.参数名称可自定义，可设置多个参数<br>3.参数类型支持密码类型，密码不明文显示<br>4.参数支持修改，删除<br>5.处理器参数支持密码类型参数 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26642-权限管理-支持设备权限/角色授权管理模型

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26642](http://10.18.42.59/issues/26642)                    |
| 用例名称                   | 权限管理-支持设备权限/角色授权管理模型                       |
| 功能编号                   |                                                              |
| 触发事件                   | 对用户进行设备权限授权                                       |
| 前置条件                   | 对用户进行设备权限授权                                       |
| 交互事件流程<br>（活动图） | ![SAK小程序二次认证流程](http://assets.processon.com/chart_image/5d5ca5b1e4b04399f5ac6fbe.png) |
| 用例说明                   | 用户申请云桌面权限，云桌面权限每次分配一个IP给用户，同时可设置此IP可访问哪些服务。用户可申请多个云桌面，每个云桌面可访问的服务不同。同步解除云桌面权限后，IP回收，对应云桌面访问服务权限也清空，不确定IP回收后，是否会分配给其他人，云桌面共有多少个IP可用是动态的，可随时扩展。 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.定义设备权限/角色，用户关联时表示用户可使用此设备，添加创建设备权限/角色功能<br>2.设备权限/角色约束单一授权，即只允许给一个用户授权，不允许授权给多个用户，同时此类权限不允许使用群组/组织/岗位授权，创建此类权限时可同时关联用户授权<br>3.设备权限可设置是否在解除用户权限/角色关系时删除，即解除授权关系时删除此权限/角色<br>4.设备角色在解除用户角色关系时清空设备角色关联的权限<br>5.设备角色与权限不能相互关联<br>6.设备角色/权限编号可定制生成<br>7.提供设备角色/权限创建接口，创建时可传入userId关联权限 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #27588-用户管理-添加定时删除系统审计日志定时任务

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#27588](http://10.18.42.59/issues/27588)                    |
| 用例名称                   | 用户管理-添加定时删除系统审计日志定时任务                    |
| 功能编号                   |                                                              |
| 触发事件                   | 用户设置定时任务                                             |
| 前置条件                   | 用户设置定时任务                                             |
| 交互事件流程<br>（活动图） |                                                         |
| 用例说明                   | SIM系统审计日志没有清理任务，数据量会越来越大，需要出厂配置定时清理任务 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.产品出厂添加审计日志清理定时任务                           |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #28572-单点登录-完善用户多账号登录访问场景

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#28572](http://10.18.42.59/issues/28572)                    |
| 用例名称                   | 单点登录-完善用户多账号登录访问场景                          |
| 功能编号                   |                                                              |
| 触发事件                   | 权限委托，主从账号                                           |
| 前置条件                   | 权限委托，主从账号                                           |
| 交互事件流程<br>（活动图） |                                                         |
| 用例说明                   | 1.权限委托在访问对应应用时触发<br>2.被授权人没有此应用权限，只要被委托，也可以委托人身份访问<br>3.用户访问其它应用不受影响<br>4.权限委托和主从账号可共用<br>5.从账号，权限委托触发异地登录和二次认证 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



### 4.11.0产品需求规格



#### #28021-权限管理-权限申请对接流程

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#28021](http://10.18.42.59/issues/28021)                    |
| 用例名称                   | 权限管理-权限申请对接流程                                    |
| 功能编号                   |                                                              |
| 触发事件                   | 权限申请                                                     |
| 前置条件                   | 对接流程平台                                                 |
| 交互事件流程<br>（活动图） | ![交互流程](http://assets.processon.com/chart_image/5d8b0a18e4b011ca2aae059a.png) |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.创建权限申请模板，模板支持自定义，控件可选择（text,textara,date,select），模板默认包含（申请人，申请类型，授权人，权限关系数据模块），不可编辑修改，提供获取模板接口，现在只支持按应用区分模板，后续再确定是否需要按权限区分模板，流程平台可能业务要创建模板，可能不需要，需预留接口调用流程平台创建模板接口，支持自定义开发<br>2.提供根据权限获取权限扩展属性接口，供申请授权填写时展示<br>3.提供发起审批接口，接口内容包括（申请人，申请类型，授权人，权限关系数据）以及权限申请模板的数据，其中权限相关数据固定。其他数据根据模板不同而不同。IDM审批接口后台调用流程平台审批接口，支持自定义开发，业务数据处理<br>4.查询审批详情接口，接口后台调用流程平台查询详情接口。支持自定义开发。<br>5.撤回审批接口，接口后台调用流程平台撤回接口支持自定义开发。<br>6.编辑审批接口，接口后台调用流程平台编辑审批接口。<br>7.提供更新审批状态回调接口，回调接口包含表单数据详情，审批状态等。<br>8.权限申请审批提供审计日志记录。<br>9.失败，驳回的审批单可编辑/重新发起审批，审批中的可撤回 |
| 数据定义                   | 权限审批表，保存权限审批申请数据<br>审批模板表，保存模板数据 |
| 非功能                     |                                                              |
| 原型图_权限流程导航| ![流程导航](http://assets.processon.com/chart_image/5d9bf0c6e4b07a0a4d4edadf.png) |
| 原型图_创建模板|![创建模板](http://assets.processon.com/chart_image/5d9ff3ace4b002a6447de644.png)|
| 原型图_编辑模板|![编辑模板](http://assets.processon.com/chart_image/5d8b0314e4b0eb752f2b8c38.png)|
| 原型图_流程模板列表|![模板列表](http://assets.processon.com/chart_image/5d9bf5e6e4b00e2b866438c4.png)|
| 原型图_权限申请记录|![申请记录](http://assets.processon.com/chart_image/5d9bf2f9e4b00e2b86642f44.png)|
| 原型图_流程平台对接管理|![对接管理](http://assets.processon.com/chart_image/5d9bf46de4b07a0a4d4ee713.png)|

#### #30567-单点登录-单点登录支持会话管理

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#30567](http://10.18.42.59/issues/30567)                    |
| 用例名称                   | 单点登录-单点登录支持会话管理                                |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   | 应用集成单点登录                                             |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.单点登录目前没有会话管理的概念，后端有一个单点登录的会话管理，但是功能并不好用，无法实现会话的管理<br/>2.单点登录的会话管理，功能较弱无法满足需求。 |
| 后置条件                   |                                                              |
| 业务规则                   | 单点登录会话管理，存在2层意义上的会话管理，第一层是单点登录一个总的会话管理，第二层是各个应用系统的会话管理<br>**第一层的全局会话管理**<br>1.会话本身应该具备以下属性<br>会话ID（TGT ID） <br>会话的来源IP<br> 会话的浏览器信息 <br>会话的创建时间 <br>会话的最大有效时间 <br>会话所属用户 <br>会话所属的从账号<br>2.实现后端的总体会话管理，可以查看到各个用户的会话情况，且可以失效会话，可以更具用户/来源IP/会话ID查询会话；<br>3.实现用户端（自助门户）可以查看自己的当前登录的会话情况，并且对于自己的会话可以实现失效的功能<br>4.支持同一个用户的会话数量限制设定，比如最多支持最新的5个会话，超过就删除会话（单一会话就配置一个会话即可）<br>**第二层各个应用系统会话管理**<br>1.应用系统会话应该具备如下属性<br>应用会话的ID <br>应用的名称 <br>登录应用的时间 <br>应用会话所属用户<br> 应用会话所属的从账号<br>2.后端可以当前用户登录了哪些应用系统。<br>3.用户（自助门户）可以看到自己的登录系统情况 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 单点登录控制台的会话管理低保真示例|![会话管理低保真](http://assets.processon.com/chart_image/5da031cae4b002a6447ea32e.png) |
|单点登录会话管理自助门户的低保真示例|![自助门户](http://assets.processon.com/chart_image/5d75e393e4b01cbe992d620f.png)|


#### #30568-用户管理-用户移动支持按类型进行组织策略（是否允许编辑）限制

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#30568](http://10.18.42.59/issues/30568)                    |
| 用例名称                   | 用户管理-用户移动支持按类型进行组织策略（是否允许编辑）限制  |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.目前移动是根据权限控制，无法根据组织类型控制。导致下面场景无法实现：内部用户允许移动，外部用户不允许移动。 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.系统设置中用户类型设置不允许编辑后，同样作用于移动事件，不允许移动<br>2.移动权限控制不受影响，但优先级比用户类型策略低 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #28731-用户管理-支持设置部门管理员及多类型组织管理，部门管理员登录后可选择对应组织类型,所管理组织按类型展示

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#28731](http://10.18.42.59/issues/28731)                    |
| 用例名称                   | 用户管理-支持设置部门管理员及多类型组织管理，部门管理员登录后可选择对应组织类型,所管理组织按类型展示 |
| 功能编号                   |                                                              |
| 触发事件                   | 设置部门管理员                                               |
| 前置条件                   | 部门管理员管理了不同类型的组织                               |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 目前部门管理员展示组织分为两种方式：<br>1.展示所有组织类型及组织，但是只能操作有权限操作的组织<br>2.只展示管理员所在的组织类型及可管理的组织，所有组织都挂在管理员所在组织类型的组织下面<br> |
| 后置条件                   |                                                              |
| 业务规则                   | 目前需求是第三种展示方式：<br/>1.展示管理员可管理的组织类型及可管理的组织，对应组织挂在对应组织类型下<br/>2.需计算出父子节点关系，如果有子节点，则需展示在父节点下面，而不是作为根节点展示<br>3.支持三种展示方式，默认采用第三种<br>4.用户管理，群组管理，岗位管理，权限管理中的组织树逻辑要一致 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #28564-用户管理-支持管理页面和上游回收账号时可分别控制是否可创建账号

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#28564](http://10.18.42.59/issues/28564)                    |
| 用例名称                   | 用户管理-支持管理页面和上游回收账号时可分别控制是否可创建账号 |
| 功能编号                   |                                                              |
| 触发事件                   | 回收创建新用户                                               |
| 前置条件                   | 同步回收新用户                                               |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 目前是否允许创建用户的策略只有一个，要么都允许创建，要么都不允许创建。无法区分创建用户的场景，例如内部用户，不允许SIM创建，但允许同步回收创建，目前无法实现。 |
| 后置条件                   |                                                              |
| 业务规则                   | 1、用户类型中允许创建用户策略下细分创建场景：同步回收，页面。默认包含所有场景，管理员可设置包含场景。可以勾选一个，也可勾选多个。 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #26229-用户管理-创建用户，UID定义为非拼音策略时，用户新建对话框上不需要按钮点击生成，新增用户账号属性专门作为账号使用。

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26229](http://10.18.42.59/issues/26229)                    |
| 用例名称                   | 用户管理-创建用户，UID定义为非拼音策略时，用户新建对话框上不需要按钮点击生成，新增用户账号属性专门作为账号使用。 |
| 功能编号                   |                                                              |
| 触发事件                   | 界面创建用户                                                 |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.目前创建用户必须手动选择账号，但是这是拼音策略才需要的功能，用户名称生成拼音时可能会有多音字，所以需要选择账号，流水号，随机数策略是不需要手动选择的<br>2.UID项目上有时仅作为唯一标识使用，不作为用户业务账号使用，因此需新增一个属性作用用户业务账号。<br>3.生成别名目前和生成用户账号冲突，别名是可以在自助中修改的，而用户账号不可修改<br/> |
| 后置条件                   |                                                              |
| 业务规则                   | 1、创建用户时如果不是拼音生成策略，则不显示生成账号按钮，后台根据策略自动生成账号。如用用户类型配置了显示UID，则展示此属性，但是不再有生成按钮，如果用户类型配置了不现实UID，则不显示此属性<br>2.LDAP新增一个属性smart-uid,作为用户业务账号使用，此属性和别名一样，可在用户类型中配置生成策略，可在新增页面，同步回收，创建接口中自动生成。全局唯一，一旦生成不允许修改。同时此属性可映射为其他属性，如用用户类型配置了显示smart-uid，则展示此属性，如果用户类型配置不显示，则不显示此属性<br>3.别名保持之前的功能不变 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![1571392412669](http://assets.processon.com/chart_image/5da98d63e4b0ece757d325f8.png) |



#### #28112-同步性能优化，支持高效率同步，支持大数据量同步

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#28112](http://10.18.42.59/issues/28112)                    |
| 用例名称                   | 同步性能优化，支持高效率同步，支持大数据量同步               |
| 功能编号                   |                                                              |
| 触发事件                   | 1.数据同步回收或推送<br>                                     |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.同步数量优化，支持百万级别数量同步<br/>2.同步效率优化，提升同步效率<br>3.同步稳定性优化，解决待同步问题<br>4.支持待同步记录可手动重试<br>5.触发推送即记录日志，不能遗漏 |
| 后置条件                   |                                                              |
| 业务规则                   | 回收部分：<br>1.减少自动生成的数量，仅保留UID，用户账号（smart-uid）<br>2.生成逻辑调整，模糊查询匹配，而不是查询多次<br>3.去掉代码锁，用redis分布式锁<br>推送部分：<br> |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #22331-权限管理-权限关系管理

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22331](http://10.18.42.59/issues/22331)                    |
| 用例名称                   | 权限管理-权限关系管理                                        |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 权限支持互斥，依赖。互斥权限不能同时授权，依赖权限必须授权依赖权限，关联权限建议应该授权<br/>1.权限关系管理要处理旧的数据,要有修复历史数据功能，也可支持不处理旧数据，不规范数据查看，如哪些用户含有互斥权限，哪些用户的权限缺少依赖权限<br/>2.权限关系管理支持界面操作，接口调用，同步回收及推送<br/>3.权限关系处理的授权数据可查看，如用户因权限互斥未授权某权限<br/>4.权限关系支持跨系统设置业务角色，IT角色，IT权限关系<br/>5.授权时互斥权限无法同时授权到同一人<br/>6.授权时依赖权限必须同时授权，同时解权限<br/>7.支持查看用户权限来源及没有权限的原因，如权限来源（群组，依赖，用户直接授权），没有权限原因（排除，移除群组，权限互斥）<br/> |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #22323-同步管理-同步对象保证顺序同步

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#22323](http://10.18.42.59/issues/22323)                    |
| 用例名称                   | 权限管理-权限关系管理                                        |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.同一个用户的操作保证是顺序同步<br/>用户修改移动顺序，禁用并移动及修改顺序<br/>必须先修改，再移动，移动会导致下游AD的DN变化，修改失败<br/>2.用户授权，取消权限，再授权，必须保证下游最后是授权状态<br/>3.用户权限关系推送顺序<br/>4.权限如果有开户权限，必须先开户，再授权其他权限；如果有依赖权限，必须先推送依赖权限再推送当前权限<br/>5.支持跨资源的顺序推送，因为权限可以跨系统依赖和互斥<br>6.可采用一致性hash算法保证相同用户对象推送的线程是同一个，需考虑集群环境消费如何保证数据一致性 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #30569-同步管理-同步失败重试支持次数限制

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#30569](http://10.18.42.59/issues/30569)                    |
| 用例名称                   | 同步管理-同步失败重试支持次数限制                            |
| 功能编号                   |                                                              |
| 触发事件                   | 同步数据失败                                                 |
| 前置条件                   | 配置了失败重试定时任务                                       |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   |                                                              |
| 后置条件                   |                                                              |
| 业务规则                   | 1.可按资源配置重试次数<br>2.同步日志增加重试时间字段，每次重试更新重试时间<br>3.同步日志增加重试次数字段，每次重试更新重试次数<br>4.重试次数超出配置后定时任务不再重试，但任然可手动重试<br>5.定时任务重试不再更新operato_time |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![重试次数配置](http://assets.processon.com/chart_image/5db6b16de4b09df551859aa5.png) |



#### #26233-优化大数据量环境下查询速度，如组织用户树，权限树查询

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#26233](http://10.18.42.59/issues/26233)                    |
| 用例名称                   | 优化大数据量环境下查询速度，如组织用户树，权限树查询         |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.审计统计查询，数据量900万，需要8秒，数据量太大可考虑备份，清理数据<br>2.权限管理-组织授权，展开组织树，需要15秒，组织数量4000<br>3.权限管理-组织授权，展示用户列表，需要15秒，用户量13万 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.上述所有查询，要求反馈在3秒以内<br>2.优化用户体验，可考虑优化后台查询逻辑，或改为 异步响应，或改为分页展示 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![重试次数配置]()                                            |



#### #34029-双源认证时LDAP密码过期，AD密码未过期时，账号是否可登录支持配置

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#34029](http://10.18.42.59/issues/34029)                    |
| 用例名称                   | 双源认证时LDAP密码过期，AD密码未过期时，账号是否可登录支持配置 |
| 功能编号                   |                                                              |
| 触发事件                   | SIAM配置双源认证                                             |
| 前置条件                   | AD和LDAP的密码过期时间不一致                                 |
| 交互事件流程<br>（活动图） | ![密码过期策略](http://assets.processon.com/chart_image/5dbfc30ae4b0ea86c4201035.png) |
| 用例说明                   | 1.LDAP密码过期，AD密码未过期，之前的老版本可以登录，新版本修改为不能登录，会提示密码过期，要求用户修改密码 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.LDAP密码过期，AD密码未过期是否可登录可配置<br>2.如果不能登录，跳转强制修改密码 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #33706-单点登录-支持集群下服务器节点配置

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#33706](http://10.18.42.59/issues/33706)                    |
| 用例名称                   | 单点登录-支持集群下服务器节点配置                            |
| 功能编号                   |                                                              |
| 触发事件                   | SIAM实施了集群                                               |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） |                                                              |
| 用例说明                   | 1.目前SIAM上传图片，LOGO等在集群环境下需要每台切换去上传<br>2.目前SIAM刷新缓存，只能刷新单机，需要每台机器都去刷新一次<br> |
| 后置条件                   |                                                              |
| 业务规则                   | 1.console支持配置集群节点，将所有服务器集群的访问节点都进行配置，保存在数据库<br>2.支持集群节点表的查询，编辑，删除，添加 |
| 数据定义                   | 集群节点表siam_cluster_config:id,name,url,description        |
| 非功能要求                 |                                                              |
| 原型图                     | ![重试次数配置](http://assets.processon.com/chart_image/5db79a3ee4b09df551864b70.png) |



#### #33095-单点登录-服务缓存刷新刷新集群的缓存，而不是当前的只能刷新某一个单机

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#33095](http://10.18.42.59/issues/33095)                    |
| 用例名称                   | 单点登录-服务缓存刷新刷新集群的缓存，而不是当前的只能刷新某一个单机 |
| 功能编号                   |                                                              |
| 触发事件                   | SIAM刷新服务器缓存                                           |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![缓存刷新](http://assets.processon.com/chart_image/5dc12dcae4b0ece7594b5665.png) |
| 用例说明                   | 1.目前SIAM刷新服务器缓存，只能刷新单机，因为缓存是存在内存里面的，管理员刷新每次都要每台机器都刷新一遍 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.新增缓存刷新接口，用于刷新服务器缓存<br>2.接口必须保证使用服务器IP可访问<br>3.管理员点击缓存刷新，后台调用集群节点配置，读取所有集群节点，每个节点调用缓存刷新接口，刷新所有服务器缓存<br>4.接口需要配置鉴权用户，在siam.properties中配置<br>5.接口https需注意证书需要导入或忽略<br>6.后台调用接口要有超时机制，超时反馈页面 |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #31865-单点登录-登录首页背景图片/登录LOGO支持上传到服务器

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#31865](http://10.18.42.59/issues/31865)                    |
| 用例名称                   | 单点登录-登录首页背景图片/登录LOGO支持上传到服务器           |
| 功能编号                   |                                                              |
| 触发事件                   | SIAM上传背景图，LOGO图片                                     |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![图片上传](http://assets.processon.com/chart_image/5dc12b46e4b002a645da70de.png) |
| 用例说明                   | 1.目前SIAM只支持背景图片，而且是单机，管理员需要每台机器都上传<br>2.不支持上传LOGO图片 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.新增图片上传接口，支持类型参数（背景图和LOGO图）<br>2.上传背景图片，后台调用集群节点，每个节点调用图片上传接口上传<br>3.上传LOGO图片，后台调用集群节点，每个节点调用图片上传接口上传<br>4.背景图，LOGO图要有大小限制<br>5.后台调用接口要有超时机制，超时反馈页面<br>6.接口需要配置鉴权用户，在siam.properties中配置<br/>7.接口https需注意证书需要导入或忽略<br/> |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #33452-企业微信支持推送头像

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#33452](http://10.18.42.59/issues/33452)                    |
| 用例名称                   | 企业微信支持推送头像                                         |
| 功能编号                   |                                                              |
| 触发事件                   | 企业微信推送头像                                             |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![企业微信头像推送](http://assets.processon.com/chart_image/5dc11e53e4b0e433945c5704.png) |
| 用例说明                   | 1.目前企业微信连接器不支持推送头像<br>2.企业微信接口不支持直接上传头像，需要先调用素材管理接口上传头像，获得素材ID，再调用用户修改接口，将素材ID作为头像参数上传。头像查询直接返回图片的URL<br> |
| 后置条件                   |                                                              |
| 业务规则                   | 1.修改连接器，支持企业微信头像推送，将SIM的photo作为入参，传到连接器<br> |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                   |





#### #36830-SIM架构升级为springboot2.x

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#36830](http://10.18.42.59/issues/36830)                    |
| 用例名称                   | 用户管理-spring升级到5.x，xml配置迁移到annotation注解中，架构升级为springboot2.x |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![无]()                                                      |
| 用例说明                   | 1.将原有springmvc架构升级为springboot2.x架构<br>2.将xml配置转为configuration注解形式<br>3.spring相关依赖升级为5.x |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #36831-SIAM架构升级为springboot2.x

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#36831](http://10.18.42.59/issues/36831)                    |
| 用例名称                   | 单点登录-spring升级到5.x，xml配置迁移到annotation注解中，架构升级为springboot2.x |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![无]()                                                      |
| 用例说明                   | 1.将原有springmvc架构升级为springboot2.x架构<br>2.将xml配置转为configuration注解形式<br>3.spring相关依赖升级为5.x |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #36345-hibanate二级缓存支持redis

| 参数                       | 说明                                      |
| -------------------------- | :---------------------------------------- |
| 需求编号                   | [#36345](http://10.18.42.59/issues/36345) |
| 用例名称                   | hibanate二级缓存支持redis                 |
| 功能编号                   |                                           |
| 触发事件                   |                                           |
| 前置条件                   |                                           |
| 交互事件流程<br>（活动图） | ![无]()                                   |
| 用例说明                   | 1.将hibernate二级缓存修改为redis实现      |
| 后置条件                   |                                           |
| 业务规则                   |                                           |
| 数据定义                   |                                           |
| 非功能要求                 |                                           |
| 原型图                     |                                           |



#### #36342-服务会话共享调整为spring redis session，实现应用管理会话共享，取消配置tomcat的会话共享

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#36342](http://10.18.42.59/issues/36342)                    |
| 用例名称                   | 服务会话共享调整为spring redis session，实现应用管理会话共享，取消配置tomcat的会话共享 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![无]()                                                      |
| 用例说明                   | 1.启用spring session,采用redis实现                           |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #34763-用户管理-修复审计日志与inspectr输送SIA日志覆盖不一致的问题

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#34763](http://10.18.42.59/issues/34763)                    |
| 用例名称                   | 用户管理-修复审计日志与inspectr输送SIA日志覆盖不一致的问题   |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![无]()                                                      |
| 用例说明                   | 1.目前SIM的审计和输出到SIA的审计内容不一致，需要统一<br>2.保证事件统一，即SIM审计到的事件，SIA审计也要有记录<br>3.保证内容统一，即SIM审计的内容，SIA也要有对应内容 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |



#### #31636-单点登录-SAML改进-改进目前SAML标准化

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31636](http://10.18.42.59/issues/31636)                    |
| 用例名称                | 单点登录-SAML改进-改进目前SAML标准化                         |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 目前单点登录存在2个标准服务，一个是googleaccountservice，一个是siam自身的service。这两个都存在一定的缺陷<br>对于google account service 需要压缩传输，但是反馈的数据不标准 <br>对于siam的service不能压缩，但是返回的数据标准<br>需要明确saml到底做成什么样，配合的客户端是否需要调整改动，需要分析讨论明确。 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #31452-单点登录-支持新的UI设计，包含移动端和PC端

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31452](http://10.18.42.59/issues/31452)                    |
| 用例名称                | 单点登录-支持新的UI设计，包含移动端和PC端                    |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 1.支持新的UI设计，包含移动端和PC端<br/>2.系统可自动识别当前是手机端还是PC端，从而采用对应UI展示 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #27674-用户自助-WEB，移动端自助重新设计，整合个人信息，应用门户，SAK小程序，UI等功能

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#27674](http://10.18.42.59/issues/27674)                    |
| 用例名称                | 用户自助-WEB，移动端自助重新设计，整合个人信息，应用门户，SAK小程序，UI等功能 |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 1. 整合自助产品，优化用户体验及使用效率<br/>2. 优化产品，提升实施效率，增强产品竞争力<br/>3.自助产品UI丑陋，信息繁杂，用户使用体验差 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #28837-PORTAL网关功能迁移到SIAM，PORTAL本身的功能保留

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#28837](http://10.18.42.59/issues/28837)                    |
| 用例名称                | PORTAL网关功能迁移到SIAM，PORTAL本身的功能保留               |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 1. PORTAL网关可实现C端或移动端应用拉起浏览器实现单点登录，这块功能需要迁移出来，需考迁移到SIAM<br/>2.要求URL传递票据加密 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #25685-用户管理-用户首页可过滤启用或禁用组织/用户

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#25685](http://10.18.42.59/issues/25685)                    |
| 用例名称                | 用户管理-用户首页可过滤启用或禁用组织/用户                   |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 问题背景： 当前组织节点下数量过多时，普通管理员需要查看当前组织的所有的启用人员和禁用人员非常麻烦<br>问题建议：希望在用户管理页面加入2个控件，一个为只显示启用用户，一个为禁用用户<br>用户首页可过滤在职及离职用户，其他功能选择树（授权，岗位管理，群组管理等）只能选择在职用户 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #34841-同步支持事件驱动推送，如授权创建下游账号，取消授权禁用下游账号等

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#34841](http://10.18.42.59/issues/34841)                    |
| 用例名称                   | 同步支持事件驱动推送，如授权创建下游账号，取消授权禁用下游账号等 |
| 功能编号                   |                                                              |
| 触发事件                   | 管理员操作SIM                                                |
| 前置条件                   | 配置同步推送                                                 |
| 交互事件流程<br>（活动图） | ![无](http://assets.processon.com/chart_image/5de5c635e4b0d1f8f2c98a09.png) |
| 用例说明                   | 1.将SIM用户的单点登录授权，取消单点登录授权，修改密码，删除操作抽取为具体的事件<br>2.同步推送事件判断支持根据SIM操作判断执行具体事件，如SIM授权触发同步创建用户<br>3.原有推送逻辑不受影响<br>4.SIM里面授权是异步的，有延迟，触发同步要实时触发，保证延迟1s以内<br>5.单点登录授权只触发对应应用的推送，不能出发其他应用<br>5.触发新增需查询下游是否存在，已经存在则触发其它事件 |
| 后置条件                   |                                                              |
| 业务规则                   |                                                              |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![原型](http://assets.processon.com/chart_image/5de5d026e4b02996f1d83c17.png) |





#### #34737-单点登录-siam.properties迁移到console中在线管理

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#34737](http://10.18.42.59/issues/34737)                    |
| 用例名称                   | 单点登录-siam.properties迁移到console中在线管理              |
| 功能编号                   |                                                              |
| 触发事件                   | 修改SIAM配置                                                 |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![无]()                                                      |
| 用例说明                   | 1.梳理properties中的配置，哪些可以抽取到数据库当中管理，项目启动后加载到内存当中<br>2.console添加管理页面，可以查看，修改配置属性，不可删除配置属性<br>3.console修改配置后自动刷新将配置缓存到内存当中<br>4.新增刷新缓存的接口，将每个节点的缓存都刷新 |
| 后置条件                   | 无                                                           |
| 业务规则                   | 1.properties配置迁移目标：properties中仅配置必要项，安装时配置必要项目即可正常启动，保证快速进入到console<br>2.console中包含基础配置，高级认证设置，系统参数设置。<br>3.配置基础认证设置，保证系统可正常集成单点登录<br>4.配置高级认证设置，可实现高级的集成，如三方登录，二次认证等<br>5.配置系统参数，可设置系统默认参数及开关，如图形验证码大小，系统页面UI主题等 |
| 数据定义                   | siam_prop_config配置数据库<br>1.id 数据库ID<br>2.name 名称<br>3.value 值<br>5.description 描述<br>6.rule 填写规则<br>7.type 参数类型标识属于哪一类的参数 |
| 非功能要求                 |                                                              |
| 原型图                     | ![无](http://assets.processon.com/chart_image/5de5d6c4e4b0e2c2989c556d.png) |





#### #32913 用户管理-支持多音字用户账号设置待确定状态，多音字账号支持首次登录或自助中重命名

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#32913](http://10.18.42.59/issues/32913)                    |
| 用例名称                   | 用户管理-支持多音字用户账号设置待确定状态，多音字账号支持首次登录或自助中重命名 |
| 功能编号                   |                                                              |
| 触发事件                   | 创建账号                                                     |
| 前置条件                   | 使用拼音生成账号                                             |
| 交互事件流程<br>（活动图） | ![无](http://assets.processon.com/chart_image/5de5f624e4b0d1f8f2ca2574.png)![无](http://assets.processon.com/chart_image/5de5f840e4b0d1f8f2ca2ae6.png) |
| 用例说明                   | 业务场景：<br/>1、员工自动开通帐号根据姓名拼音生成错误帐号，这种属于常态发生（常态）<br/>2、领导对于自动生成的账号不满意，需要修改自己的账号（偶发）<br>当前如果遇到了拼音是多音字的情况，回收的时候会作为异常出现失败，此时需要管理员去到同步日志，查看并处理，当前存在几个问题<br>1.出现问题后，管理员不知情，需要每天盯着看才能知道<br> 2.出现问题后，处理不方便，需要手动建立一个账号，并再次触发同步，才能将数据回收回来<br> 3.出现问题后，管理员也无法知道用户的正确拼音是什么，还需要咨询用户才能完成数据的修正 |
| 后置条件                   |                                                              |
| 业务规则                   | 新增smart-uid字段，可自动生成，也可页面手动填写，而且字段映射可修改和重新定义。此字段用作系统交互，登录，唯一标识使用。IDM各个系统统一展示使用smart-uid.删除别名，拼音生成的生成策略，仅保留一个拼音生成策略，uid,smart-uid仅一个字段可配置拼音策略<br>场景1：使用UID+别名，系统之间交互用户UID交互，UID作为唯一标识，也作为登录账号，各个系统展示UID，别名作为用户自维护的登录账号 <br>场景2：使用UID+smart-uid+别名，系统之间交互采用smart-uid交互，UID只作为唯一标识，各个系统展示smart-uid,smart-uid作为登录账号，别名作为用户自维护的登录账号<br> 场景3：支持UID/smart-uid重命名，首次登录，自助，管理员可修改一次登录账号。<br><br>解决方案：<br> 1.回收/接口创建账号，遇到多音字添加用户多音字状态，不允许推送，用户首次登录强制修改密码后跳转强制修改账号页面,用户修改完成后修改用户状态为正常，可正常推送到下游，支持开关，默认打开，所有SIAM认证接口要消化这个字段。<br> 2.多音字状态，通知用户账号是多音字，请确认，如果需要修改请前往自助修改。修改后用户状态为正常。支持开关。 <br>3.接口，日志记录，权限，管理员，群组等需要考虑smart-uid时使用场景。接口可考虑入参支持多属性，入口是userId,但后台使用多属性查询。<br>4.配合通知机制，实现多音字出现问题后，管理员可以得到通知，关于同步的通知，参考通知设计 [#33518](http://10.18.42.59/issues/33518)<br/>5.创建页面对拼音策略可点击按钮自动生成，同时可选择多音字。如果uid是拼音生成策略则是uid自动生成，如果smart-uid是拼音生成策略则自动生成是smart-uid |
| 数据定义                   |                                                              |
| 非功能要求                 |                                                              |
| 原型图                     | ![原型](http://assets.processon.com/chart_image/5de5fb08e4b0b2fab7428411.png)![原型](http://assets.processon.com/chart_image/5daffccae4b04913a278de39.png) |



#### #31871-用户管理-支持维护SIM,SIS的系统LOGO,导航栏title,页尾版权信息，集成应用图片

| 参数                       | 说明                                                         |
| -------------------------- | :----------------------------------------------------------- |
| 需求编号                   | [#31871](http://10.18.42.59/issues/31871)                    |
| 用例名称                   | 用户管理-支持维护SIM,SIS的系统LOGO,导航栏title,页尾版权信息，集成应用图片 |
| 功能编号                   |                                                              |
| 触发事件                   |                                                              |
| 前置条件                   |                                                              |
| 交互事件流程<br>（活动图） | ![图片上传](http://assets.processon.com/chart_image/5dc12b46e4b002a645da70de.png) |
| 用例说明                   | 1.SIM可维护SIM,SIS的LOGO，首页图片，页尾信息，title信息，应用管理中的应用图片，参考SIAM上传图片功能，可沿用原有LOGO信息管理功能。<br>2.可配置SIM,SIS节点信息，可沿用SIM系统设置，节点设置功能<br>3.添加信息上传接口上传图片或title等信息。title,页尾保存数据库，图片保存文件，数据库中保存图片访问URL。<br>4.上传的信息调用每个节点的接口上传信息。 |
| 后置条件                   |                                                              |
| 业务规则                   | 1.新增上传信息及图片接口<br>2.上传信息，后台调用集群节点，每个节点调用图片上传接口上传<br>3.上传信息后，后台调用集群节点，每个节点刷新缓存 <br>4.后台调用接口要有超时机制，超时反馈页面 <br>5.接口需要配置鉴权用户，在siam.properties中配置 <br>6.接口https需注意证书需要导入或忽略 |
| 数据定义                   | 修改原有sim_logo_info表，修改为sim_display_info<br>1.id<br>2.name<br>3.system_name 系统名称（SIM/SIS）<br>4.info_type 信息类型（logo,首页，title,页尾）<br>5.content 内容（图片url,title及页尾内容）<br>6.图片规格（可沿用之前的配置） |
| 非功能要求                 |                                                              |
| 原型图                     |                                                              |





#### #31870-单点登录-支持导航栏标题切换,页尾版权更换，Header，按钮颜色的调整

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31870](http://10.18.42.59/issues/31870)                    |
| 用例名称                | 支持导航栏标题切换,页尾版权更换，Header，按钮颜色的调整      |
| 功能编号                |                                                              |
| 触发事件                | SIAM修改导航title，页尾信息，header及按钮颜色                |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传](http://assets.processon.com/chart_image/5dc12b46e4b002a645da70de.png) |
| 用例说明                | 1.SIAM支持导航栏标题变更 2.SIAM支持也尾巴版权信息维护 3.SIAM支持登录页头部颜色变更 4.SIAM支持登录按钮颜色变更 |
| 后置条件                |                                                              |
| 业务规则                | 1.新增上传信息及图片接口<br/>2.上传信息，后台调用集群节点，每个节点调用图片上传接口上传<br/>3.上传信息后，后台调用集群节点，每个节点刷新缓存 <br/>4.后台调用接口要有超时机制，超时反馈页面 <br/>5.接口需要配置鉴权用户，在siam.properties中配置 <br/>6.接口https需注意证书需要导入或忽略 |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #37856-SIM,SIS,SIAM,SAK,SSOPORTAL,SIA等系统统一显示字段

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31856](http://10.18.42.59/issues/31856)                    |
| 用例名称                | SIM,SIS,SIAM,SAK,SSOPORTAL,SIA等系统统一显示字段             |
| 功能编号                |                                                              |
| 触发事件                |                                                              |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前唯一标识和登录字段可能是分开的，因此在系统内及各个关联系统之间的交互需要指定显示字段<br>SIM：<br>增加配置：显示字段设置，可选择UID或者smart-uid显示，如果有用户类型没有smart-uid字段，则显示UID。<br>影响显示范围：1.右上角登录用户2.编辑，删除，启用，禁用，移动，修改密码，访问授权的上方TAB账号显示<br><br>影响查询范围：<br>统一入参查询字段，默认包含UID及smart-uid，可设置其他字段进行查询<br>统一查询返回字段，默认包含UID及smart-uid,可设置其他字段进行返回<br>影响范围：委托授权，兼职用户管理，设置用户管理员，静态群组添加成员，静态群组成员管理，群组设置管理员，岗位成员管理，岗位添加成员，用户授权，权限查询的查询及展示<br><br>审计统计,如果配置的是UID则显示UID，如果配置的是smart-uid则显示smart-uid，如果有用户类型没有smart-uid则显示UID。<br>SIA审计：默认结构保持不变，如果有smart-uid，则扩展字段添加smart-uid<br>接口,支持传入UID及smart-uid<br><br>SIS：<br><br>1.右上角用户名显示，支持单独配置<br>2.权限委托<br><br><br>SIAM:<br>1.委托授权显示账号<br>2.认证属性默认添加smart_uid<br>3.系统返回属性默认添加smart-uid<br>SIA,SIB等：<br>1.支持smart-uid及UID认证<br>2.支持smart-uid及UID显示账号<br>SAK:<BR>1.支持smart_uid及UID显示账号 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #37855-整理SIM,SIAM配置项，配置梳理，字段梳理

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31855](http://10.18.42.59/issues/31855)                    |
| 用例名称                | 整理SIM,SIAM配置项，梳理配置，字段，用户状态可以做那些操作等 |
| 功能编号                |                                                              |
| 触发事件                | 整理SIM,SIAM配置项，梳理配置，字段，用户状态可以做那些操作等 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                |                                                              |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![系统权限](http://assets.processon.com/chart_image/5dedf9cbe4b0dba2615460d0.png)![系统权限](http://assets.processon.com/chart_image/5dee235ce4b00859676aa46e.png) |





#### #31856-用户属性分类

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31856](http://10.18.42.59/issues/31856)                    |
| 用例名称                | 用户属性分类                                                 |
| 功能编号                |                                                              |
| 触发事件                | 创建编辑用户                                                 |
| 前置条件                | 用户属性很多                                                 |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前用户属性很多，需要在创建和编辑的时候分类展示，可以设置分类及类别展示顺序，可以维护分类下有哪些属性 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![原型](http://assets.processon.com/chart_image/5e12a456e4b0bcfb733461c3.png) |



#### #42537-用户管理-用户敏感信息加密存储

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#42537](http://10.18.42.59/issues/42537)                    |
| 用例名称                | 用户管理-用户敏感信息加密存储                                |
| 功能编号                |                                                              |
| 触发事件                | 创建编辑用户                                                 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传](http://assets.processon.com/chart_image/5e3a92c7e4b0a3daae7cb18e.png) |
| 用例说明                | 为了防止系统脱库导致信息泄露，因此需要对用户敏感信息进行加密操作。用户敏感信息加密存储需要加密的地方:<br>1.LDAP.2.数据库审计及同步日志表.3.日志文件<br>用户敏感信息影响<br>1.敏感信息字段可配置<br>2.敏感信息支持查询<br>3.敏感信息支持接口返回,接口控制是否返回敏感属性<br>4.敏感信息支持认证<br>5.敏感信息页面隐藏展示，不支持修改<br>6.加密字段切换为非加密字段，需重新同步 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![原型](http://assets.processon.com/chart_image/5e3a9436e4b0a3daae7cb3e9.png) |



#### #31832-权限管理-权限管理支持分级分权

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31832](http://10.18.42.59/issues/32832)                    |
| 用例名称                | 权限管理-权限管理支持分级分权                                |
| 功能编号                |                                                              |
| 触发事件                | 设置应用管理                                                 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前应用管理员可以管理该应用的所有权限，无法进行更细粒度的权限控制，比如只授权管理员管理应用下的某一些权限。因此需要该功能对应用权限进行细粒度权限控制<br>1.应用管理员可设置可管理应用的指定权限<br>2.应用管理员只能查看，搜索，操作有权限管理的权限<br>3.应用管理员可授权新的应用管理员，但子应用管理员权限不能超过当前应用管理员。 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #42881-SIM系统权限梳理，交互调整

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#42881](http://10.18.42.59/issues/42881)                    |
| 用例名称                | SIM系统权限梳理，交互调整                                    |
| 功能编号                |                                                              |
| 触发事件                | 设置系统的各个管理员如部门管理员，群组管理员，应用管理员等   |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前SIM系统的管理员操作非常麻烦，不利于操作，同时不支持批量操作，需要简化系统权限设置相关操作。 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![原型](http://assets.processon.com/chart_image/5dedf9cbe4b0dba2615460d0.png) |



#### #40114-用户管理-用户属性支持分类展示

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#40114](http://10.18.42.59/issues/40114)                    |
| 用例名称                | 用户管理-用户属性支持分类展示                                |
| 功能编号                |                                                              |
| 触发事件                | 编辑用户属性                                                 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前用户属性不支持分类，属性多了不方便查看<br>SIM支持设置属性类别，及排序，支持按用户类型给用户属性分类 SIM,SIS的用户属性展示页面支持分类展示用户属性 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #37885-整理SIM系统管理配置项，优化系统管理配置操作

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#37885](http://10.18.42.59/issues/40114)                    |
| 用例名称                | 整理SIM系统管理配置项，优化系统管理配置操作                  |
| 功能编号                |                                                              |
| 触发事件                | 操作系统设置                                                 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前系统配置有很多冗余，不易操作，需要优化                   |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![系统配置](http://assets.processon.com/chart_image/5dee235ce4b00859676aa46e.png) |



#### #42894-用户管理-用户关联属性（岗位，组织）展示详细关联信息

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#31832](http://10.18.42.59/issues/32832)                    |
| 用例名称                | 用户管理-用户关联属性（岗位，组织）展示详细关联信息          |
| 功能编号                |                                                              |
| 触发事件                | 用户关联其他实体对象ID                                       |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前用户关联的岗位，组织等都是ID关联，不知道关联的具体对象<br>用户信息中支持展示关联岗位，组织的详细对象信息 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #34206-用户管理-用户编辑页面支持展示及维护多值属性

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#34206](http://10.18.42.59/issues/34206)                    |
| 用例名称                | 用户管理-用户编辑页面支持展示及维护多值属性                  |
| 功能编号                |                                                              |
| 触发事件                | 有多值属性需要展示及维护                                     |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前用户编辑页面无法展示及维护多值属性，需要支持展示及维护多值属性，可考虑用textarea来展示及维护维护 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #33561-账号管理-产品异常日志打印整理，实现异常编码，并提供异常原因的说明

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33561](http://10.18.42.59/issues/33561)                    |
| 用例名称                | 账号管理-产品异常代码整理，实现异常编码，并提供异常原因的说明 |
| 功能编号                |                                                              |
| 触发事件                | 产品打印错误日志                                             |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） |                                                              |
| 用例说明                | 1.目前产品日志不规范，实施人员无法看懂问题，改进目标：实施人员能看懂，并且能初步处理问题，总体规范参考伟哥日志总体规范文档。  <br> |
|                         | 2.历史非ERROR级别的日志，暂不做处理，但新开发的内容需要按照规范执行  <br/> |
|                         | 3.ERROR级别的错误日志，采用错误码的形式打印，一个错误码对应一个错误，并附加文档详细解释错误可能的原因以及建议检查及解决的方向。所有抛出或者catch的异常，必须在默认的异常解释类中有定义。  <br/> |
|                         | 4.方法中有业务逻辑出错的，可自定义异常抛出<br/>  ![属性未找到](http://assets.processon.com/chart_image/5e65b331e4b06578661d4557.png)  <br/> |
|                         | 5.代码中抛出异常不抛出exception，代码中catch异常不catch任何exception，无论抛出异常还是catch异常，都必须是具体的有错误码对应的异常。catch任何exception只作为保证程序不报错的补救措施。  <br/>  ![捕获异常](http://assets.processon.com/chart_image/5e65b382e4b0c4a11f260ca3.png)<br/> |
|                         | 6.梳理产品连接器代码，产品连接器出厂抛出异常必须有code码  <br/>  ![connector](http://assets.processon.com/chart_image/5e65b433e4b0e40bc1d9056b.png)  <br/> |
|                         | 7.接口异常码和系统日志异常码分开打印，原因：使用场景不一样，例如查询，接口需要返回错误码的，SIM页面只需要返回空即可。  <br/> |
|                         | 8.异常码统一梳理规范错误打印信息，附带code码，code码在文档中可查看详细解释以及建议的解决方案。参考异常码参考表。  <br/> |
|                         | 9.检查代码，多用optional，尽量避免空指针异常。  <br/>  ![optional](http://assets.processon.com/chart_image/5e65b558e4b05fe7f81e87d5.png)  <br/> |
| 后置条件                |                                                              |
| 业务规则                | 错误码可参考SIM异常码参考表，系统错误常见的问题大致分类：1.数据问题导致 2.配置不正确导致3.中间件连接异常导致，本次改动，4.产品BUG，旨在说明前三个部分的异常，让实施人员能独立解决大部分问题 |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  | ![1583721683701](http://assets.processon.com/chart_image/5e65acffe4b069aa4e56a7d4.png) |

#### SIM异常码参考					

序号	|	异常名称	|	异常编号	|	说明	|
---|---|---|---|---|---|---|
1	|	LDAPException	|	101	|	LDAP操作异常，一般是操作LDAP时出现异常，建议检查LDAP连接是否正常，查询的LDAP Filter是否正确，操作的属性是否正确等	|
2	|	ApiException	|	102	|	发送邮件时异常，建议检查邮箱API调用是否正常	|
3	|	LDAPSearchException	|	103	|	LDAP查询异常，是LDAPException的子类，一般是查询LDAP时出现异常，建议检查LDAP连接是否正常，查询的LDAP Filter是否正确等	|
4	|	ConnectionException	|	104	|	LDAP连接异常，是LDAPException的封装，一般是尝试连接LDAP时出现异常，建议检查LDAP连接是否正常，连接参数是否正确等	|
5	|	GroupTypeNotFoundException	|	105	|	群组类型未找到异常，一般是数据库配置问题，找不到对应的群组类型，检查sim_grouptype表，群组默认有StaticGroup，DynamicGroup，CombinationGroup，GroupContainer，PublicContainer这5重	|
6	|	AttributeNotFoundException	|	106	|	属性映射未找到异常，一般是属性映射没有找到，建议检查SIM系统设置中的属性配置，是否有异常中提到的属性，没有的话需手动添加映射	|
7	|	GroupAttributeNotFoundException	|	107	|	群组属性映射未找到异常，一般是群组属性映射没有找到，建议检查SIM系统设置中的对应群组类型的群组属性配置，是否有异常中提到的属性，没有的话需手动添加映射	|
8	|	UserAttributeNotFoundException	|	108	|	用户属性映射未找到异常，一般是用户属性映射没有找到，建议检查SIM系统设置中的对应用户类型的用户属性配置，是否有异常中提到的属性，没有的话需手动添加映射	|
9	|	UserTypeNotFoundException	|	109	|	用户类型未找到，需检查对应的用户类型是否存在或者缓存是否刷新	|
10	|	PersistsException	|	110	|	数据库操作异常，需要详细检查异常原因，可能是sql语句不对，可能是数据库链接异常等，原因很多，均是数据库相关的异常	|
11	|	UidMappingNotFoundException	|	111	|	同步资源的主键映射未找到异常，同步资源的属性映射中未配置主键映射，同步模块要求映射配置必须配置主键	|
12	|	BehaviorJudgementNotFoundException	|	112	|	同步资源的操作配置未配置异常，同步资源的配置不能为空，至少要配置新增判断策略	|
13	|	AddBehaviorJudgementNotFoundException	|	113	|	同步资源的新增操作配置未配置异常，同步资源的配置不能为空，至少要配置新增判断策略	|
14	|	CategoryNotFoundException	|	114	|	类别配置未找到异常，需检查系统配置中类别设定是否有对应类别，默认类别产品出厂会自带，数据脚本导入出错可能会引起此异常	|
15	|	JobTypeNotFoundException	|	115	|	岗位类型未找到，需检查对应的岗位类型是否存在或者缓存是否刷新	|
16	|	JobAttributeNotFoundException	|	116	|	岗位属性未找到，需检查对应的岗位类型中的属性映射是否存在或者缓存是否刷新	|
17	|	OrganizationTypeNotFoundException	|	117	|	组织类型未找到，需检查对应的组织类型是否存在或者缓存是否刷新	|
18	|	OrganizationAttributeNotFoundException	|	118	|	组织属性未找到，需检查对应的组织类型中的属性映射是否存在或者缓存是否刷新	|
19	|	SettingNotFoundException	|	119	|	全局设定配置未找到异常，需检查系统设置的全局设定中是否有对应的配置项，一般脚本导入不全会有此问题	|
20	|	EntlSettingNotFoundException	|	120	| 权限解析未配置异常，需检查系统设置中IT权限解析设置是否配置了对应应用的权限解析，未配置就不会进行权限解析	|
21	|	MetaDataNotFoundException	|	121	|	数据字典数据未找到异常，需检查数据字典是否配置了对应的数据	|
22	|	ServiceException	|	122	|	定制服务异常，一般是项目上定制的实现类抛出的异常，需检查具体异常内容。	|
23	|	ReconPolicyNotFoundException	|	123	|	同步资源回收策略未找到，需检查对应同步回收资源的同步策略是否配置，回收资源必须配置回收资源策略	|
24	|	BadHanyuPinyinOutputFormatCombination	|	124	|	汉字拼音转换异常，创建账号策略为拼音策略时可能会抛出，一般是汉字入参不正确导致	|
25	|	GlobalSettingNotFoundException	|	125	|	同步全局设置未找到异常，需检查同步管理中全局设置是否有参数未配置，一般是数据库脚本导入不正确导致	|
26	|	IOException	|	126	|	输入输出异常，一般是上传下载，接口调用等场景出现，可能是网络问题	|
27	|	TemplateException	|	127	|	模板异常，一般是短信邮件模板替换内容时出现，可能是模板错误或内容问题	|
28	|	WSSecurityException	|	128	|	base64转码异常，一般是base64的入参错误	|
29	|	UnsupportedEncodingException	|	129	|	字符编码转换异常，可能是编码未写正确，如UTF-8写成了UTF-S	|
30	|	ParseException	|	130	|	日期转换异常，一般是日期格式不正确	|
31	|	NumberFormatException	|	131	|	数字转换异常，一般是数字格式不正确	|
32	|	ApiUserNotFoundException	|	132	|	鉴权用户未找到异常，一般是接口调用时SIM未找到对应的鉴权用户	|
33	|	ProvGlobalPolicyNotFoundException	|	133	|	同步推送资源全局策略未找到，需检查对应同步推送资源的同步策略是否配置，资源必须配置同步策略	|
34	|	ProvModPolicyNotFoundException	|	134	|	同步推送资源修改策略未找到，需检查对应同步推送资源的同步策略是否配置，资源必须配置同步策略	|
35	|	ProvDelPolicyNotFoundException	|	135	|	同步推送资源删除策略未找到，需检查对应同步推送资源的同步策略是否配置，资源必须配置同步策略	|
36	|	ProvAddPolicyNotFoundException	|	136	|	同步推送资源新增策略未找到，需检查对应同步推送资源的同步策略是否配置，资源必须配置同步策略	|
37	|	MessagingException	|	137	|	邮件信息异常，构建邮件内容时出现错误，正常不会出现此异常	|
38	|	ClassNotFoundException	|	138	|	未找到对应类，一般是项目上定制类，配置的实现类没有找到	|
39	|	ConnectorException	|	139	|	连接器异常，一般是连接器内部抛出的异常	|
40	|	GeneralSecurityException	|	140	|	证书异常，一般是服务器证书导致的问题，证书未找到等	|
41	|	IllegalParamException	|	141	|	非法属性异常，如入参属性不对等，一般是接口抛出	|

#### #33559-同步管理-同步日志记录字段变更情况

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33561](http://10.18.42.59/issues/33561)                    |
| 用例名称                | 同步管理-同步日志记录字段变更情况                            |
| 功能编号                |                                                              |
| 触发事件                | 同步记录同步日志                                             |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | AS<br/>1.目前同步只记录了变更，没有记录具体变更了哪些字段，管理员无法查看具体的变更信息<br/>TO BE<br/>1. 同步日志记录变更了哪些字段，管理员可查看具体的变更字段和变更的内容<br>2.管理员可查看用户以及用户上下游数据情况，可对比展示数据差异 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #33518-通知管理-完善SIM的消息通知机制-实现按事件的消息通知

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33518](http://10.18.42.59/issues/33518)                    |
| 用例名称                | 通知管理-完善SIM的消息通知机制-实现按事件的消息通知          |
| 功能编号                |                                                              |
| 触发事件                | 同步记录同步日志                                             |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 当前的消息通知是分散的，固定不可配置的，一些事件无法实现消息的通知，且通知无法自定义通知到具体的人，无法自定义通知的模板<br>1.实现基于事件的消息通知机制，支持按照事件配置消息通知<br>2.事件消息通知内容可配置化，可以按照每个事件单独配置消息通知<br> 3.实现消息通知对象可配置化，可以按照组织，群组，个人的方式设定通知对象<br> 4.实现基于消息队列的消息通知<br> 5.通知方式支持，短信，邮件，和内部消息，可以单选，多选通知方式<br> 6.开启消息通知服务，可以供其他产品调用发送通知， 其他产品可以直接通过通知ID直接发送通知<br>7.通知的内部消息：实现按照用户的消息通知到系统，用户登录后可以点击消息模块，查看自己的通知信息<br>8.关于同步是否按照应用来通知，需要再次明确讨论，这里需要结合应用管理员的维度，配合应用的权限管理来实现 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #33419-同步管理-同步日志失败详细信息同步到SIA

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33419](http://10.18.42.59/issues/33419)                    |
| 用例名称                | 同步管理-同步日志失败详细信息同步到SIA                       |
| 功能编号                |                                                              |
| 触发事件                | 同步记录同步日志，并发送到SIA                                |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 同步日志异常需要细化到实施人员能够看懂，参考#33561<br>同时同步日志code信息需要同步到SIA，可供实施人员查看 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #33394-用户管理-支持自定义字段作为用户账号，用户账号支持按策略生成

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33394](http://10.18.42.59/issues/33394)                    |
| 用例名称                | 用户管理-支持自定义字段作为用户账号，用户账号支持按策略生成  |
| 功能编号                |                                                              |
| 触发事件                | 创建用户                                                     |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前用户账号已经固定为uid或smart-uid（可配置），需和强哥确认为什么还需要自动逸用户策略生成属性，会导致同步性能问题 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



#### #33921-已经禁用的用户还能做哪些操作可配置，如移动，改密码，修改信息，授权

| 参数                    | 说明                                                         |
| :---------------------- | :----------------------------------------------------------- |
| 需求编号                | [#33394](http://10.18.42.59/issues/33394)                    |
| 用例名称                | 已经禁用的用户还能做哪些操作可配置，如移动，改密码，修改信息，授权 |
| 功能编号                |                                                              |
| 触发事件                | 操作禁用用户                                                 |
| 前置条件                |                                                              |
| 交互事件流程 （活动图） | ![图片上传]()                                                |
| 用例说明                | 目前禁用用户所有操作都可做，不合理，可设置禁用用户默认仅允许移动（移动到禁用节点），可配置其他操作。 |
| 后置条件                |                                                              |
| 业务规则                |                                                              |
| 数据定义                |                                                              |
| 非功能要求              |                                                              |
| 原型图                  |                                                              |



### 待确认产品需求规格

